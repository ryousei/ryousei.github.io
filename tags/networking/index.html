<!DOCTYPE HTML>

<html lang="en">
  
<head>
  <meta charset="utf-8">
  
  <title>networking | My Reading List</title>
  <meta name="author" content="Ryousei Takano">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="My Reading List"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <meta http-equiv="Content-Language" content="en"/>
  

  <link href="/img/favicon.png" rel="icon">
  
    <link rel="apple-touch-icon" href="/img/apple-icon.png">
    <link rel="apple-touch-icon-precomposed" href="/img/apple-icon.png">
    

  <link rel="alternate" href="/atom.xml" title="My Reading List" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  
  <style type="text/css">
  /* Tim Pietrusky advanced checkbox hack (Android <= 4.1.2) */
body{ -webkit-animation: bugfix infinite 1s; }
@-webkit-keyframes bugfix { from {padding:0;} to {padding:0;} }

  

  
    article .post-content-index .entry{max-height: 550px; overflow:hidden;}
  
</style>

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'null', 'auto');
  ga('send', 'pageview');
 
</script>




  
    
      <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400|Playball' rel='stylesheet' type='text/css'>
    
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.11.1.min.js"></script>

  



</head>


<body>
  <header id="header" class="inner"><div class="padding">
	<div class="alignleft logo">
	  <h1><a href="/">My Reading List</a></h1>
	</div>
	<nav id="main-nav" class="alignright">
		<input type="checkbox" id="toggle" />
		<label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu" onclick><i class="fa fa-bars"></i></label>
	  <ul class="menu">
	    
	      <li><a href="/">Home</a></li>
	    
	      <li><a href="/archives">Archives</a></li>
	    
	    
	  </ul>
	</nav>
	<div class="clearfix"></div>
</div>
</header>
  <div id="page-heading-wrap">
  	<div class="inner">
      <div class="padding">
    		
          <h2>A diary of a computer scientest</h2>
        
      </div>
  	</div>
  </div>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper" class="padding">
<h2 class="archive-title tag">networking</h2>


  
    <article class="post">
  
  
    <div class="post-content-index">
  
      
        <header>
          <div class="icon"></div>
            
    
      <h1 class="title transition"><a href="/2014/12/15/SENIC-Scalable-NIC-for-End-Host-Rate-Limiting/">SENIC: Scalable NIC for End-Host Rate Limiting</a></h1>
    
  
          <ul>
            <li>
              <span class="heading-span">Posted on: </span>
              <time datetime="2014-12-15T12:52:18.000Z">Dec 15 2014</time>
            </li>
            
              <li>
                <span class="heading-span">By: </span>

                
                  <a href="/">Ryousei Takano</a>
                

              </li>
            
            <li>
              <span class="heading-span">With: </span>
              
          </ul>
        </header>
      
      <div class="entry">
        
          
            <p>Title: SENIC: Scalable NIC for End-Host Rate Limiting<br>Authors: Sivasankar Radhakrishnan, University of California, San Diego; Yilong Geng and Vimalkumar Jeyakumar, Stanford University; Abdul Kabbani, Google Inc.; George Porter, University of California, San Diego; Amin Vahdat, Google Inc. and University of California, San Diego<br>2014 USENIX NSDI [<a href="https://www.usenix.org/conference/nsdi14/technical-sessions/presentation/radhakrishnan" target="_blank" rel="external">URL</a>]</p>
<hr>
<ul>
<li>The authors present <em>SENIC</em>, a scalable rate limiting NIC design that can support tens of thousands of rate limiters per server.</li>
<li>Network resource managers, including <em>Seawall</em> [HotCloud2010], <em>Oktopus</em> [SIGCOMM2011], and <em>EyeQ</em> [NSDI2013], require programmable rate limiters.</li>
<li>SENIC removes TX ring buffers from a NIC, because SRAM is expensive and limited.  The SENIC prototype is implemented on NetFPGA 10G, with 1000 rate limiters requiring just only 30KB SRAM.</li>
<li>The source code is available from <a href="http://jvimal.github.io/senic/" target="_blank" rel="external">here</a>.</li>
</ul>

          
        
      </div>
      <footer>
        
          <div class="alignright">
            <a href="/2014/12/15/SENIC-Scalable-NIC-for-End-Host-Rate-Limiting/#more" class="more-link">Continue Reading<i class="fa fa-long-arrow-right fa-1"></i></a>
          </div>
        
        <div class="clearfix"></div>
      </footer>
    </div>
</article>



  
    <article class="post">
  
  
    <div class="post-content-index">
  
      
        <header>
          <div class="icon"></div>
            
    
      <h1 class="title transition"><a href="/2014/12/10/Improving-Server-Application-Performance-via-Pure-TCP-ACK-Receive-Optimization/">Improving Server Application Performance via Pure TCP ACK Receive Optimization</a></h1>
    
  
          <ul>
            <li>
              <span class="heading-span">Posted on: </span>
              <time datetime="2014-12-09T22:37:26.000Z">Dec 10 2014</time>
            </li>
            
              <li>
                <span class="heading-span">By: </span>

                
                  <a href="/">Ryousei Takano</a>
                

              </li>
            
            <li>
              <span class="heading-span">With: </span>
              
          </ul>
        </header>
      
      <div class="entry">
        
          
            <p>Title: Improving Server Application Performance via Pure TCP ACK Receive Optimization<br>Authors: Michael Chan and David R. Cheriton, Stanford University<br>2013 USENIX ATC [<a href="https://www.usenix.org/conference/atc13/technical-sessions/presentation/chan" target="_blank" rel="external">URL</a>]</p>
<hr>
<ul>
<li>The authors present <em>TCP-PARO</em>, (Pure ACK Receive Optimization), that removes the bulk of expensive per-packet processing and provides a fast processing path of pure ACKs in the network stack (bypasses the original stack).<ul>
<li>Pure ACK parsing and demultiplexing</li>
<li>ACK processing fast module</li>
<li>Handling a mixture of pure ACKs and other TCP segments</li>
</ul>
</li>
<li>The authors show that ACK receive processing can consume up to 20% CPU cycles in a Web server.  Using this technique, they demonstrate cycles savings of 15%, and 33% throughput improvement in reliable multicast, <em>TCP-SMO</em> [INFOCOM2002].</li>
<li>While some batching optimization have been proposed to amortize receive-side overhead for data packet, they are not suitable for small control packets like ACKs.</li>
<li>By the way, the last author is famous as his work, <em>V operating system</em>, in 80s.</li>
</ul>

          
        
      </div>
      <footer>
        
          <div class="alignright">
            <a href="/2014/12/10/Improving-Server-Application-Performance-via-Pure-TCP-ACK-Receive-Optimization/#more" class="more-link">Continue Reading<i class="fa fa-long-arrow-right fa-1"></i></a>
          </div>
        
        <div class="clearfix"></div>
      </footer>
    </div>
</article>



  
    <article class="post">
  
  
    <div class="post-content-index">
  
      
        <header>
          <div class="icon"></div>
            
    
      <h1 class="title transition"><a href="/2014/12/08/ClickOS-and-the-Art-of-Network-Function-Virtualization/">ClickOS and the Art of Network Function Virtualization</a></h1>
    
  
          <ul>
            <li>
              <span class="heading-span">Posted on: </span>
              <time datetime="2014-12-08T00:24:04.000Z">Dec 8 2014</time>
            </li>
            
              <li>
                <span class="heading-span">By: </span>

                
                  <a href="/">Ryousei Takano</a>
                

              </li>
            
            <li>
              <span class="heading-span">With: </span>
              
          </ul>
        </header>
      
      <div class="entry">
        
          
            <p>Title: ClickOS and the Art of Network Function Virtualization<br>Authors: Joao Martins and Mohamed Ahmed, NEC Europe Ltd.; Costin Raiciu and Vladimir Olteanu, University Politehnica of Bucharest; Michio Honda, Roberto Bifulco, and Felipe Huici, NEC Europe Ltd.<br>2014 USENIX NSDI [<a href="https://www.usenix.org/conference/nsdi14/technical-sessions/presentation/martins" target="_blank" rel="external">URL</a>]<br>Reference:</p>
<ul>
<li><a href="http://cnp.neclab.eu/" target="_blank" rel="external">Cloud Networking Platform Lab</a> (NEC Europe)</li>
</ul>
<hr>
<ul>
<li>The authors presents <em>ClickOS</em>, a high-performance, virtualize software middlebox platform.</li>
<li>To support fast and easily programmable middlebox platform, ClickOS implements a minimalistic guest OS that is organized to run <em><a href="http://www.read.cs.ucla.edu/click/" target="_blank" rel="external">Click</a></em>, a software modular router, at rates of millions of packets per second.  It is built on top of MiniOS in the Xen hypervisor.  The authors also introduce the <em>VALE</em> switch [CoNEXT2012] instead of Open vSwitch as the backend switch.  To do that, they modified the Xen netback driver to implement the netmap API.</li>
<li>To demonstrate the feasibility, the authors test the following middlebox applications: Wire, EtherMonitor, IP Router, Firewall, Carrier Grade NAT, Software Broadband Remote Access Server, Intrusion Detection System, Load Balancer, and Flow Monitor.</li>
<li>The source code is available from <a href="https://github.com/cnplab/clickos/" target="_blank" rel="external">cnplab@github</a>.</li>
</ul>

          
        
      </div>
      <footer>
        
          <div class="alignright">
            <a href="/2014/12/08/ClickOS-and-the-Art-of-Network-Function-Virtualization/#more" class="more-link">Continue Reading<i class="fa fa-long-arrow-right fa-1"></i></a>
          </div>
        
        <div class="clearfix"></div>
      </footer>
    </div>
</article>



  
    <article class="post">
  
  
    <div class="post-content-index">
  
      
        <header>
          <div class="icon"></div>
            
    
      <h1 class="title transition"><a href="/2014/12/07/Speeding-up-packet-I-O-in-virtual-machines/">Speeding up packet I/O in virtual machines</a></h1>
    
  
          <ul>
            <li>
              <span class="heading-span">Posted on: </span>
              <time datetime="2014-12-07T02:43:12.000Z">Dec 7 2014</time>
            </li>
            
              <li>
                <span class="heading-span">By: </span>

                
                  <a href="/">Ryousei Takano</a>
                

              </li>
            
            <li>
              <span class="heading-span">With: </span>
              
          </ul>
        </header>
      
      <div class="entry">
        
          
            <p>Title: Speeding up packet I/O in virtual machines<br>Authors: Luigi Rizzo, Giuseppe Lettieri, Vincenzo Maffione, Università di Pisa, Italy<br>2013 IEEE/ACM ANCS [<a href="https://sites.google.com/a/ancsconf.org/2013/conference-program" target="_blank" rel="external">URL</a>]<br>Reference:</p>
<ul>
<li><a href="http://info.iet.unipi.it/~luigi/netmap/" target="_blank" rel="external">The netmap project</a> (Università di Pisa)</li>
</ul>
<hr>
<ul>
<li>The authors applies netmap and other techniques to QEMU achieving 5 Mpps with <em><a href="https://www.usenix.org/conference/usenixsecurity12/technical-sessions/presentation/rizzo" target="_blank" rel="external">netmap</a></em> [USENIX2012], 1 Mpps with sockets between VMs over an emulated e1000.<ul>
<li>interrupt moderation</li>
<li>send combination [USENIX2002]: a driver-based form of batching and interrupt moderation</li>
</ul>
</li>
<li>They focus on high packet rates instead of high throughput on virtualized networks.  That enables a new set of applications, including software routers, middlebox, SDN, and so on, within virtual machines.</li>
<li>They also use <em>VALE</em> [CoNEXT2012] as a virtual switch.</li>
</ul>

          
        
      </div>
      <footer>
        
          <div class="alignright">
            <a href="/2014/12/07/Speeding-up-packet-I-O-in-virtual-machines/#more" class="more-link">Continue Reading<i class="fa fa-long-arrow-right fa-1"></i></a>
          </div>
        
        <div class="clearfix"></div>
      </footer>
    </div>
</article>



  
    <article class="post">
  
  
    <div class="post-content-index">
  
      
        <header>
          <div class="icon"></div>
            
    
      <h1 class="title transition"><a href="/2014/12/06/netmap-a-novel-framework-for-fast-packet-I-O/">netmap: a novel framework for fast packet I/O</a></h1>
    
  
          <ul>
            <li>
              <span class="heading-span">Posted on: </span>
              <time datetime="2014-12-06T06:37:33.000Z">Dec 6 2014</time>
            </li>
            
              <li>
                <span class="heading-span">By: </span>

                
                  <a href="/">Ryousei Takano</a>
                

              </li>
            
            <li>
              <span class="heading-span">With: </span>
              
          </ul>
        </header>
      
      <div class="entry">
        
          
            <p>Title: netmap: A Novel Framework for Fast Packet I/O<br>Authors: Luigi Rizzo, Università di Pisa, Italy<br>2012 USENIX ATC [<a href="https://www.usenix.org/conference/usenixsecurity12/technical-sessions/presentation/rizzo" target="_blank" rel="external">URL</a>] (<strong>Best paper award</strong>)<br>Reference:</p>
<ul>
<li><a href="http://info.iet.unipi.it/~luigi/netmap/" target="_blank" rel="external">The netmap project</a> (Università di Pisa)</li>
</ul>
<hr>
<ul>
<li>The author presents <em>netmap</em>, a novel framework that enables commodity operating systems to handle the millions of packets per second (pps), without requiring custom hardwares and changes to applications.</li>
<li>In order to build network applications like network monitors and packet generators, UNIX provides raw packet I/O APIs, e.g., Berkeley Packet Filter (BPF) and AF_SOCKET, however, the performance is inadequate for the millions of pps on a 10 gigabit link.</li>
<li>netmap integrates some well-known existing ideas into commodity OSs to reduce the cost of moving traffic between the NIC and the network stack.  For example, NetChannels is a similar idea, and it is employed in <a href="/2014/12/04/OSv-Optimizing-the-Operating-System-for-Virtual-Machines/">OSv</a> [USENIX2014].<ul>
<li>per-packet dynamic memory allocations, removed by preallocating resources</li>
<li>system call overheads, amortized over large batches</li>
<li>memory copies, eliminated by sharing buffers and metadata between kernel and userspace</li>
</ul>
</li>
<li>The following snippet is an example code of packet generator using netmap API.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">fds.fd = open(<span class="string">"/dev/netmap"</span>, O_RDWR);</div><div class="line"><span class="built_in">strcpy</span>(nmr.nm_name, <span class="string">"ix0"</span>);</div><div class="line">ioctl(fds.fd, NIOCREG, &nmr);</div><div class="line">p = mmap(<span class="number">0</span>, nmr.memsize, fds.fd);</div><div class="line">nifp = NETMAP_IF(p, nmr.offset);</div><div class="line">fds.events = POLLOUT;</div><div class="line"><span class="keyword">for</span> (;;) {</div><div class="line">    poll(fds, <span class="number">1</span>, -<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; nmr.num_queues; r++) {</div><div class="line">        ring = NETMAP_TXRING(nifp, r);</div><div class="line">        <span class="keyword">while</span> (ring-&gt;avail-- &gt; <span class="number">0</span>) {</div><div class="line">            i = ring-&gt;cur;</div><div class="line">            buf = NETMAP_BUF(ring, ring-&gt;slot[i].buf_index);</div><div class="line">            ... store the payload into buf ...</div><div class="line">            ring-&gt;slot[i].len = ... <span class="comment">// set packet length</span></div><div class="line">            ring-&gt;cur = NETMAP_NEXT(ring, i);</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li>netmap is orthogonal to hardware offloading (checksum, TSO, LRO) and virtualization (VMDc, SR-IOV) mechanisms.  The authors have been proposed a netmap-based software switch, <em>VALE</em> [CoNEXT2012] [ANCS2013].</li>
<li>netmap has been implemented in FreeBSD and Linux.  The recent FreeBSD has already included it, and also the latest implementation is available from <a href="https://code.google.com/p/netmap/" target="_blank" rel="external">Google code page</a>.</li>
</ul>

          
        
      </div>
      <footer>
        
          <div class="alignright">
            <a href="/2014/12/06/netmap-a-novel-framework-for-fast-packet-I-O/#more" class="more-link">Continue Reading<i class="fa fa-long-arrow-right fa-1"></i></a>
          </div>
        
        <div class="clearfix"></div>
      </footer>
    </div>
</article>



  
    <article class="post">
  
  
    <div class="post-content-index">
  
      
        <header>
          <div class="icon"></div>
            
    
      <h1 class="title transition"><a href="/2014/12/05/mTCP-a-Highly-Scalable-User-level-TCP-Stack-for-Multicore-Systems/">mTCP: a Highly Scalable User-level TCP Stack for Multicore Systems</a></h1>
    
  
          <ul>
            <li>
              <span class="heading-span">Posted on: </span>
              <time datetime="2014-12-04T23:54:03.000Z">Dec 5 2014</time>
            </li>
            
              <li>
                <span class="heading-span">By: </span>

                
                  <a href="/">Ryousei Takano</a>
                

              </li>
            
            <li>
              <span class="heading-span">With: </span>
              
          </ul>
        </header>
      
      <div class="entry">
        
          
            <p>Title: mTCP: a Highly Scalable User-level TCP Stack for Multicore Systems<br>Authors: EunYoung Jeong, Shinae Woo, Muhammad Jamshed, and Haewon Jeong, Korea Advanced Institute of Science and Technology (KAIST); Sunghwan Ihm, Princeton University; Dongsu Han and KyoungSoo Park, Korea Advanced Institute of Science and Technology (KAIST)<br>2014 USENIX NSDI [<a href="https://www.usenix.org/conference/nsdi14/technical-sessions/presentation/jeong" target="_blank" rel="external">URL</a>] (<strong>Community award</strong>)<br>Reference:</p>
<ul>
<li><a href="http://shader.kaist.edu/mtcp/" target="_blank" rel="external">mTCP</a> (KAIST)</li>
</ul>
<hr>
<ul>
<li>The authors presents <em>mTCP</em>, a highly scalable user-level TCP stack for multicore systems.</li>
<li>Large flows are easy to fill up 10 Gbps. But, small flows are hard to fill up 10 Gbps regardless of the number of CPU cores.  This is because the Linux kernel is not designed for multicore systems.  In a web server case, 83% of CPU usage spent inside kernel.</li>
<li>Several proposals for improving in-kernel TCP performance, including <em>affinity accept</em> [EuroSys2012], <em>MegaPipe</em> [OSDI2012], and <em>FlexSC</em> [OSDI2010], however, they are not sufficient.  As another approach, mTCP, <em>SolarFlare <a href="http://www.openonload.org/" target="_blank" rel="external">OpenOnload</a></em> and <em>Sandstorm</em> [SIGCOMM2014] run the entire network stack in the userspace to eliminate kernel crossing overheads and optimize packet processing without kernel modifications.</li>
<li>mTCP makes full use of extreme parallelism and batch processing:<ul>
<li>Per-core resource management (listening queue, file descriptor, packet queue)</li>
<li>Lock-free data structures and cache-aware threading</li>
<li>Eliminate system call overhead</li>
<li>Reduce context switch cost by event batching</li>
<li>Easily portable APIs for compatibility (similar to BSD socket API)</li>
</ul>
</li>
<li>This group has proposed <em>PacketShader</em>, GPU-accelerated software router in the ACM SIGCOMM 2010.  As a part of mTCP (user-level pacekt I/O library), they extend PacketShader I/O engine (PSIO) to support an efficient event-driven packet I/O interface.  Other user-level packet I/O engines have been proposed, including <em>Intel DPDK</em> and <em><a href="/2014/12/06/netmap-a-novel-framework-for-fast-packet-I-O/">netmap</a></em> [USENIX2012].</li>
<li>The source code is available from <a href="https://github.com/eunyoung14/mtcp" target="_blank" rel="external">eunyoung14@github</a>.</li>
</ul>

          
        
      </div>
      <footer>
        
          <div class="alignright">
            <a href="/2014/12/05/mTCP-a-Highly-Scalable-User-level-TCP-Stack-for-Multicore-Systems/#more" class="more-link">Continue Reading<i class="fa fa-long-arrow-right fa-1"></i></a>
          </div>
        
        <div class="clearfix"></div>
      </footer>
    </div>
</article>



  

  <nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav>




   </div></div>
    <aside id="sidebar" class="alignright"><div class="padding">
	
	  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>
	
	  
<div class="widget recent-post">
  <h3 class="title">Recent Posts</h3>
  <ul class="entry">
    
      <li>
        <a href="/2014/12/15/SENIC-Scalable-NIC-for-End-Host-Rate-Limiting/">SENIC: Scalable NIC for End-Host Rate Limiting</a>
      </li>
    
      <li>
        <a href="/2014/12/13/Software-Persistent-Memory/">Software Persistent Memory</a>
      </li>
    
      <li>
        <a href="/2014/12/12/Software-Techniques-for-Avoiding-Hardware-Virtualization-Exits/">Software Techniques for Avoiding Hardware Virtualization Exits</a>
      </li>
    
      <li>
        <a href="/2014/12/10/Improving-Server-Application-Performance-via-Pure-TCP-ACK-Receive-Optimization/">Improving Server Application Performance via Pure TCP ACK Receive Optimization</a>
      </li>
    
      <li>
        <a href="/2014/12/09/Lightweight-Memory-Tracing/">Lightweight Memory Tracing</a>
      </li>
    
  </ul>
</div>

	
	  
	
	  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  
    <a href="/tags/kernel/">kernel<small>1</small></a>
  
    <a href="/tags/memory/">memory<small>2</small></a>
  
    <a href="/tags/networking/">networking<small>6</small></a>
  
    <a href="/tags/virtualization/">virtualization<small>7</small></a>
  
</div>

	
</div></aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="padding">
	<div class="alignleft">
	  
	  &copy; 2014 Ryousei Takano
	  
	  Powerd by <a href="http://hexo.io/" target="_blank">hexo</a>
	  and Theme by <a href="https://github.com/halfer53/metro-light" target="_blank">metro-light</a>
	</div>

	<div class="alignright">
		
		
		
		
		
		
		
	</div>

	<div class="clearfix"></div>
</div>

<div class="scroll-top"><i class="fa fa-arrow-circle-up"></i></div></footer>
  


<script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/3.0.4/jquery.imagesloaded.js"></script>
<script src="/js/gallery.js"></script>



<script type="text/javascript">
$(window).scroll(function() {

    if($(this).scrollTop() > 400) {
        $('.scroll-top').fadeIn(200);
    } else {
        $('.scroll-top').fadeOut(200);
    }
});

$('.scroll-top').bind('click', function(e) {
    e.preventDefault();
    $('body,html').animate({scrollTop:0},200);
});
</script>


</body>
</html>
